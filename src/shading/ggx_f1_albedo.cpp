/*
Copyright (C) 2017-2021 Topological Manifold

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/

#include "ggx_f1_albedo.h"

#include <src/numerical/interpolation.h>

#include <array>

namespace ns::shading
{
namespace
{
// clang-format off

constexpr std::array<int, 2> GGX_F1_ALBEDO_COSINE_ROUGHNESS_SIZE = {32, 32};
constexpr std::array<int, 1> GGX_F1_ALBEDO_COSINE_WEIGHTED_AVERAGE_SIZE = {32};

template <std::size_t N, typename T>
constexpr std::array<T, 0> GGX_F1_ALBEDO_COSINE_ROUGHNESS;

template <std::size_t N, typename T>
constexpr std::array<T, 0> GGX_F1_ALBEDO_COSINE_WEIGHTED_AVERAGE;

template <typename T>
constexpr std::array GGX_F1_ALBEDO_COSINE_ROUGHNESS<3, T> = std::to_array<T>
({
        0.998792, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        0.951041, 0.999709, 0.999932, 0.999971, 0.999984, 0.999990, 0.999993, 0.999995,
        0.999996, 0.999997, 0.999998, 0.999998, 0.999998, 0.999999, 0.999999, 0.999999,
        0.999999, 0.999999, 0.999999, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        0.984768, 0.993936, 0.998710, 0.999468, 0.999713, 0.999822, 0.999880, 0.999913,
        0.999936, 0.999951, 0.999961, 0.999969, 0.999974, 0.999979, 0.999982, 0.999985,
        0.999988, 0.999990, 0.999991, 0.999993, 0.999994, 0.999995, 0.999996, 0.999996,
        0.999997, 0.999997, 0.999998, 0.999998, 0.999999, 0.999999, 1.000000, 1.000000,
        0.992948, 0.969371, 0.992173, 0.996823, 0.998337, 0.998988, 0.999329, 0.999523,
        0.999648, 0.999730, 0.999787, 0.999830, 0.999863, 0.999888, 0.999906, 0.999922,
        0.999934, 0.999944, 0.999952, 0.999960, 0.999966, 0.999971, 0.999976, 0.999979,
        0.999983, 0.999986, 0.999989, 0.999992, 0.999993, 0.999995, 0.999997, 0.999999,
        0.995963, 0.937325, 0.974978, 0.988724, 0.993990, 0.996367, 0.997598, 0.998308,
        0.998760, 0.999056, 0.999261, 0.999413, 0.999528, 0.999612, 0.999676, 0.999729,
        0.999773, 0.999807, 0.999838, 0.999861, 0.999883, 0.999901, 0.999917, 0.999929,
        0.999941, 0.999951, 0.999961, 0.999970, 0.999975, 0.999982, 0.999988, 0.999994,
        0.997377, 0.921265, 0.951022, 0.973059, 0.984361, 0.990195, 0.993453, 0.995368,
        0.996614, 0.997425, 0.997999, 0.998410, 0.998715, 0.998952, 0.999129, 0.999268,
        0.999387, 0.999485, 0.999563, 0.999627, 0.999683, 0.999733, 0.999769, 0.999808,
        0.999839, 0.999863, 0.999887, 0.999908, 0.999926, 0.999943, 0.999959, 0.999972,
        0.998141, 0.920067, 0.931357, 0.953167, 0.969230, 0.979312, 0.985642, 0.989643,
        0.992299, 0.994123, 0.995397, 0.996339, 0.997043, 0.997578, 0.997990, 0.998319,
        0.998590, 0.998802, 0.998982, 0.999134, 0.999257, 0.999365, 0.999459, 0.999543,
        0.999609, 0.999672, 0.999726, 0.999775, 0.999814, 0.999854, 0.999882, 0.999915,
        0.998592, 0.925847, 0.920844, 0.935535, 0.951740, 0.964617, 0.973844, 0.980424,
        0.985047, 0.988375, 0.990796, 0.992602, 0.993976, 0.995043, 0.995882, 0.996542,
        0.997080, 0.997521, 0.997887, 0.998184, 0.998451, 0.998664, 0.998854, 0.999014,
        0.999160, 0.999282, 0.999394, 0.999489, 0.999573, 0.999643, 0.999717, 0.999776,
        0.998869, 0.933599, 0.918106, 0.923738, 0.936116, 0.948823, 0.959619, 0.968117,
        0.974696, 0.979768, 0.983677, 0.986676, 0.989009, 0.990856, 0.992349, 0.993523,
        0.994510, 0.995306, 0.995969, 0.996533, 0.997015, 0.997415, 0.997755, 0.998072,
        0.998335, 0.998565, 0.998760, 0.998941, 0.999100, 0.999244, 0.999367, 0.999481,
        0.999047, 0.940914, 0.919555, 0.917669, 0.924698, 0.934758, 0.945060, 0.954309,
        0.962189, 0.968706, 0.974028, 0.978291, 0.981754, 0.984615, 0.986934, 0.988887,
        0.990457, 0.991804, 0.992893, 0.993846, 0.994655, 0.995340, 0.995959, 0.996464,
        0.996905, 0.997316, 0.997670, 0.997984, 0.998260, 0.998504, 0.998731, 0.998938,
        0.999159, 0.947083, 0.923197, 0.915687, 0.917469, 0.923959, 0.932187, 0.940792,
        0.948877, 0.956133, 0.962403, 0.967833, 0.972346, 0.976251, 0.979514, 0.982271,
        0.984611, 0.986631, 0.988328, 0.989772, 0.991038, 0.992146, 0.993095, 0.993940,
        0.994650, 0.995309, 0.995894, 0.996411, 0.996842, 0.997261, 0.997621, 0.997959,
        0.999222, 0.952081, 0.927149, 0.916139, 0.913732, 0.916378, 0.921960, 0.928807,
        0.936153, 0.943271, 0.949928, 0.955924, 0.961318, 0.965958, 0.970083, 0.973766,
        0.976885, 0.979576, 0.981938, 0.984078, 0.985885, 0.987488, 0.988884, 0.990171,
        0.991264, 0.992241, 0.993118, 0.993893, 0.994598, 0.995256, 0.995831, 0.996343,
        0.999258, 0.955852, 0.930971, 0.917538, 0.911894, 0.911495, 0.914300, 0.919002,
        0.924891, 0.931044, 0.937390, 0.943449, 0.949140, 0.954409, 0.959132, 0.963370,
        0.967269, 0.970689, 0.973792, 0.976502, 0.978973, 0.981135, 0.983100, 0.984830,
        0.986404, 0.987813, 0.989087, 0.990218, 0.991229, 0.992204, 0.993046, 0.993816,
        0.999266, 0.958474, 0.933949, 0.919285, 0.911324, 0.908259, 0.908583, 0.911107,
        0.915297, 0.920236, 0.925677, 0.931160, 0.936716, 0.941934, 0.947047, 0.951715,
        0.956108, 0.960071, 0.963772, 0.967123, 0.970145, 0.972949, 0.975412, 0.977768,
        0.979848, 0.981700, 0.983430, 0.985022, 0.986476, 0.987737, 0.988937, 0.990051,
        0.999259, 0.960140, 0.936103, 0.920483, 0.911046, 0.906011, 0.904137, 0.904811,
        0.907126, 0.910515, 0.914855, 0.919564, 0.924472, 0.929403, 0.934354, 0.939155,
        0.943723, 0.948039, 0.952149, 0.956002, 0.959545, 0.962832, 0.965862, 0.968717,
        0.971315, 0.973703, 0.975956, 0.978018, 0.979874, 0.981626, 0.983238, 0.984743,
        0.999231, 0.960992, 0.937343, 0.921285, 0.910636, 0.904096, 0.900615, 0.899450,
        0.900110, 0.901995, 0.905042, 0.908694, 0.912689, 0.917065, 0.921605, 0.926149,
        0.930677, 0.935106, 0.939307, 0.943408, 0.947317, 0.950989, 0.954416, 0.957753,
        0.960794, 0.963759, 0.966389, 0.968959, 0.971273, 0.973553, 0.975554, 0.977497,
        0.999197, 0.961182, 0.937569, 0.921110, 0.909574, 0.901889, 0.897104, 0.894462,
        0.893756, 0.894275, 0.895867, 0.898458, 0.901547, 0.905081, 0.908948, 0.913030,
        0.917157, 0.921419, 0.925571, 0.929767, 0.933747, 0.937481, 0.941329, 0.944899,
        0.948358, 0.951526, 0.954788, 0.957669, 0.960487, 0.963145, 0.965637, 0.968069,
        0.999146, 0.960728, 0.936986, 0.920160, 0.907957, 0.899346, 0.893316, 0.889556,
        0.887444, 0.886793, 0.887223, 0.888573, 0.890605, 0.893323, 0.896345, 0.899880,
        0.903444, 0.907194, 0.911057, 0.914999, 0.918841, 0.922779, 0.926560, 0.930394,
        0.933963, 0.937552, 0.940941, 0.944194, 0.947290, 0.950354, 0.953312, 0.956040,
        0.999091, 0.959667, 0.935723, 0.918368, 0.905634, 0.896045, 0.889202, 0.884316,
        0.881075, 0.879327, 0.878724, 0.878950, 0.879948, 0.881738, 0.883864, 0.886596,
        0.889413, 0.892626, 0.896047, 0.899593, 0.903137, 0.906954, 0.910626, 0.914229,
        0.917935, 0.921482, 0.924949, 0.928491, 0.931849, 0.935097, 0.938383, 0.941478,
        0.999023, 0.958148, 0.933650, 0.915648, 0.902298, 0.892079, 0.884208, 0.878472,
        0.874267, 0.871402, 0.869897, 0.869163, 0.869306, 0.870073, 0.871272, 0.873067,
        0.875366, 0.877739, 0.880553, 0.883585, 0.886712, 0.889977, 0.893373, 0.896745,
        0.900270, 0.903671, 0.907198, 0.910706, 0.914066, 0.917567, 0.920860, 0.924197,
        0.998944, 0.956230, 0.930839, 0.912344, 0.898236, 0.887156, 0.878624, 0.871977,
        0.867019, 0.863293, 0.860754, 0.859036, 0.858301, 0.858055, 0.858571, 0.859390,
        0.860923, 0.862522, 0.864602, 0.866921, 0.869511, 0.872311, 0.875251, 0.878232,
        0.881337, 0.884472, 0.887862, 0.890992, 0.894363, 0.897686, 0.900963, 0.904336,
        0.998863, 0.953904, 0.927496, 0.908238, 0.893288, 0.881632, 0.872349, 0.864810,
        0.858929, 0.854408, 0.851102, 0.848423, 0.846771, 0.845728, 0.845338, 0.845452,
        0.845892, 0.846931, 0.848259, 0.849787, 0.851683, 0.853804, 0.856188, 0.858621,
        0.861286, 0.864042, 0.866701, 0.869782, 0.872827, 0.875809, 0.878850, 0.882028,
        0.998769, 0.951221, 0.923576, 0.903479, 0.887640, 0.875009, 0.865083, 0.856856,
        0.850254, 0.844816, 0.840603, 0.837342, 0.834733, 0.832847, 0.831706, 0.830961,
        0.830746, 0.830968, 0.831271, 0.832128, 0.833314, 0.834785, 0.836321, 0.838121,
        0.840274, 0.842477, 0.844792, 0.847107, 0.849615, 0.852313, 0.854862, 0.857826,
        0.998680, 0.948306, 0.919152, 0.897945, 0.881322, 0.868038, 0.857212, 0.848120,
        0.840804, 0.834549, 0.829513, 0.825463, 0.822149, 0.819419, 0.817250, 0.815849,
        0.814711, 0.814003, 0.813841, 0.813977, 0.814323, 0.815087, 0.815907, 0.816969,
        0.818373, 0.819784, 0.821435, 0.823372, 0.825410, 0.827434, 0.829705, 0.831872,
        0.998572, 0.945032, 0.914317, 0.891886, 0.874375, 0.860136, 0.848449, 0.838724,
        0.830368, 0.823471, 0.817719, 0.812724, 0.808743, 0.805287, 0.802441, 0.800151,
        0.798351, 0.796954, 0.795949, 0.795127, 0.795064, 0.794928, 0.794925, 0.795288,
        0.795847, 0.796828, 0.797755, 0.798932, 0.800260, 0.801544, 0.803217, 0.804791,
        0.998471, 0.941569, 0.909157, 0.885406, 0.866925, 0.851619, 0.839168, 0.828470,
        0.819552, 0.811873, 0.805269, 0.799740, 0.794653, 0.790650, 0.786960, 0.784037,
        0.781459, 0.779195, 0.777536, 0.775943, 0.775027, 0.774198, 0.773613, 0.773071,
        0.773125, 0.773051, 0.773402, 0.773818, 0.774293, 0.775089, 0.775908, 0.776907,
        0.998353, 0.937919, 0.903702, 0.878634, 0.858810, 0.842761, 0.829088, 0.817797,
        0.808004, 0.799481, 0.792193, 0.785846, 0.780194, 0.775117, 0.771104, 0.767225,
        0.763848, 0.761127, 0.758546, 0.756590, 0.754619, 0.753076, 0.751791, 0.750729,
        0.749782, 0.749275, 0.748918, 0.748603, 0.748343, 0.748371, 0.748491, 0.748744,
        0.998236, 0.933991, 0.897784, 0.871255, 0.850332, 0.833152, 0.818782, 0.806449,
        0.795926, 0.786557, 0.778496, 0.771538, 0.765216, 0.759611, 0.754577, 0.750123,
        0.746017, 0.742598, 0.739438, 0.736671, 0.734098, 0.731788, 0.729773, 0.728115,
        0.726524, 0.725251, 0.724177, 0.723013, 0.722016, 0.721622, 0.721029, 0.720468,
        0.998127, 0.930006, 0.891630, 0.863602, 0.841337, 0.823053, 0.807949, 0.794656,
        0.783341, 0.773242, 0.764638, 0.756719, 0.749762, 0.743493, 0.737730, 0.732709,
        0.727942, 0.723880, 0.720132, 0.716602, 0.713243, 0.710576, 0.707911, 0.705511,
        0.703232, 0.701350, 0.699550, 0.697803, 0.696432, 0.695054, 0.693925, 0.692756,
        0.997991, 0.925684, 0.885259, 0.855632, 0.832209, 0.812994, 0.796622, 0.782617,
        0.770338, 0.759527, 0.750122, 0.741539, 0.733892, 0.727054, 0.720707, 0.714867,
        0.709558, 0.704885, 0.700510, 0.696427, 0.692740, 0.689226, 0.685983, 0.682847,
        0.680282, 0.677508, 0.675246, 0.672984, 0.671010, 0.668936, 0.667167, 0.665521,
        0.997868, 0.921325, 0.878755, 0.847481, 0.822685, 0.802376, 0.785038, 0.770187,
        0.757315, 0.745692, 0.735591, 0.726336, 0.718066, 0.710323, 0.703475, 0.697192,
        0.691391, 0.685781, 0.681042, 0.676270, 0.672081, 0.668081, 0.664284, 0.660562,
        0.657458, 0.654354, 0.651477, 0.648896, 0.646193, 0.643732, 0.641254, 0.639299,
        0.997732, 0.916915, 0.872053, 0.838975, 0.813084, 0.791545, 0.773349, 0.757472,
        0.743819, 0.731600, 0.720585, 0.710793, 0.701718, 0.693667, 0.686215, 0.679295,
        0.673161, 0.667205, 0.661566, 0.656370, 0.651616, 0.646995, 0.642825, 0.638908,
        0.635119, 0.631510, 0.628048, 0.625133, 0.621990, 0.619025, 0.616300, 0.613632
});

template <typename T>
constexpr std::array GGX_F1_ALBEDO_COSINE_WEIGHTED_AVERAGE<3, T> = std::to_array<T>
({
        0.999998, 0.999945, 0.999940, 0.999755, 0.999306, 0.998515, 0.997274, 0.995464,
        0.992974, 0.989691, 0.985517, 0.980358, 0.974127, 0.966741, 0.958128, 0.948281,
        0.937144, 0.924682, 0.910944, 0.895921, 0.879737, 0.862412, 0.844116, 0.824911,
        0.805038, 0.784568, 0.763744, 0.742653, 0.721568, 0.700504, 0.679755, 0.659249
});

template <typename T>
constexpr std::array GGX_F1_ALBEDO_COSINE_ROUGHNESS<4, T> = std::to_array<T>
({
        0.999835, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        0.951044, 0.999710, 0.999932, 0.999971, 0.999984, 0.999990, 0.999993, 0.999995,
        0.999996, 0.999997, 0.999998, 0.999998, 0.999998, 0.999999, 0.999999, 0.999999,
        0.999999, 0.999999, 0.999999, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        0.984759, 0.993942, 0.998703, 0.999463, 0.999715, 0.999822, 0.999881, 0.999914,
        0.999936, 0.999950, 0.999961, 0.999968, 0.999974, 0.999978, 0.999982, 0.999985,
        0.999987, 0.999989, 0.999991, 0.999992, 0.999994, 0.999995, 0.999995, 0.999996,
        0.999997, 0.999998, 0.999998, 0.999999, 0.999999, 0.999999, 1.000000, 1.000000,
        0.992930, 0.969366, 0.992160, 0.996821, 0.998333, 0.998986, 0.999327, 0.999523,
        0.999644, 0.999728, 0.999786, 0.999829, 0.999861, 0.999885, 0.999904, 0.999920,
        0.999932, 0.999943, 0.999950, 0.999958, 0.999965, 0.999970, 0.999975, 0.999979,
        0.999982, 0.999986, 0.999989, 0.999990, 0.999993, 0.999995, 0.999997, 0.999998,
        0.995947, 0.937279, 0.974877, 0.988675, 0.993944, 0.996333, 0.997572, 0.998293,
        0.998744, 0.999041, 0.999249, 0.999404, 0.999517, 0.999603, 0.999671, 0.999721,
        0.999766, 0.999800, 0.999833, 0.999854, 0.999877, 0.999897, 0.999912, 0.999925,
        0.999937, 0.999946, 0.999957, 0.999965, 0.999972, 0.999978, 0.999984, 0.999990,
        0.997355, 0.921007, 0.950839, 0.972884, 0.984230, 0.990107, 0.993371, 0.995317,
        0.996559, 0.997381, 0.997954, 0.998374, 0.998678, 0.998909, 0.999097, 0.999243,
        0.999362, 0.999455, 0.999535, 0.999600, 0.999661, 0.999710, 0.999751, 0.999786,
        0.999820, 0.999845, 0.999872, 0.999892, 0.999909, 0.999930, 0.999945, 0.999957,
        0.998106, 0.919651, 0.930932, 0.952839, 0.968910, 0.979068, 0.985391, 0.989444,
        0.992113, 0.993968, 0.995261, 0.996206, 0.996915, 0.997465, 0.997890, 0.998222,
        0.998503, 0.998719, 0.998912, 0.999066, 0.999190, 0.999301, 0.999402, 0.999481,
        0.999552, 0.999615, 0.999673, 0.999725, 0.999770, 0.999804, 0.999839, 0.999872,
        0.998549, 0.925120, 0.919963, 0.934827, 0.951156, 0.963994, 0.973346, 0.979926,
        0.984597, 0.987990, 0.990417, 0.992275, 0.993677, 0.994751, 0.995631, 0.996299,
        0.996856, 0.997314, 0.997695, 0.998008, 0.998266, 0.998497, 0.998696, 0.998870,
        0.999008, 0.999144, 0.999255, 0.999359, 0.999448, 0.999529, 0.999599, 0.999668,
        0.998806, 0.932349, 0.916668, 0.922478, 0.934844, 0.947609, 0.958511, 0.967170,
        0.973816, 0.978949, 0.982879, 0.985949, 0.988333, 0.990249, 0.991761, 0.993009,
        0.993999, 0.994834, 0.995529, 0.996121, 0.996616, 0.997059, 0.997421, 0.997730,
        0.997996, 0.998243, 0.998458, 0.998651, 0.998825, 0.998978, 0.999117, 0.999240,
        0.998967, 0.938974, 0.917496, 0.915528, 0.922624, 0.932797, 0.943076, 0.952533,
        0.960518, 0.967149, 0.972573, 0.976952, 0.980508, 0.983437, 0.985843, 0.987823,
        0.989463, 0.990826, 0.992014, 0.992997, 0.993850, 0.994591, 0.995207, 0.995757,
        0.996254, 0.996684, 0.997046, 0.997388, 0.997695, 0.997963, 0.998202, 0.998419,
        0.999052, 0.944546, 0.920015, 0.912507, 0.914224, 0.920869, 0.929174, 0.937906,
        0.946154, 0.953547, 0.959955, 0.965435, 0.970180, 0.974167, 0.977540, 0.980396,
        0.982794, 0.984911, 0.986687, 0.988242, 0.989552, 0.990747, 0.991747, 0.992608,
        0.993424, 0.994110, 0.994730, 0.995260, 0.995772, 0.996238, 0.996615, 0.996976,
        0.999093, 0.948630, 0.922992, 0.911564, 0.909019, 0.911883, 0.917368, 0.924420,
        0.931880, 0.939217, 0.946008, 0.952139, 0.957662, 0.962530, 0.966837, 0.970557,
        0.973799, 0.976690, 0.979239, 0.981414, 0.983347, 0.985046, 0.986575, 0.987894,
        0.989052, 0.990128, 0.991088, 0.991922, 0.992698, 0.993400, 0.994046, 0.994635,
        0.999106, 0.951459, 0.925278, 0.911359, 0.905571, 0.905008, 0.907899, 0.912817,
        0.918789, 0.925169, 0.931552, 0.937843, 0.943664, 0.949069, 0.954039, 0.958487,
        0.962525, 0.966149, 0.969366, 0.972261, 0.974871, 0.977167, 0.979260, 0.981121,
        0.982828, 0.984376, 0.985771, 0.986993, 0.988137, 0.989149, 0.990112, 0.990951,
        0.999087, 0.953057, 0.926750, 0.911202, 0.902847, 0.899662, 0.899859, 0.902662,
        0.906826, 0.911921, 0.917453, 0.923204, 0.928937, 0.934373, 0.939650, 0.944527,
        0.949089, 0.953298, 0.957193, 0.960733, 0.963968, 0.966900, 0.969632, 0.972078,
        0.974319, 0.976414, 0.978235, 0.979970, 0.981534, 0.982975, 0.984328, 0.985513,
        0.999045, 0.953561, 0.927188, 0.910448, 0.900300, 0.894852, 0.893060, 0.893575,
        0.895929, 0.899468, 0.903961, 0.908747, 0.913817, 0.919055, 0.924162, 0.929112,
        0.933921, 0.938600, 0.942815, 0.946797, 0.950595, 0.954152, 0.957389, 0.960425,
        0.963240, 0.965811, 0.968213, 0.970498, 0.972590, 0.974492, 0.976221, 0.977906,
        0.998989, 0.953332, 0.926473, 0.908787, 0.897272, 0.890133, 0.886446, 0.885082,
        0.885870, 0.887687, 0.890730, 0.894557, 0.898761, 0.903315, 0.907951, 0.912676,
        0.917471, 0.922073, 0.926631, 0.930909, 0.934937, 0.938913, 0.942722, 0.946201,
        0.949499, 0.952508, 0.955497, 0.958244, 0.960792, 0.963233, 0.965510, 0.967679,
        0.998914, 0.952198, 0.924893, 0.906343, 0.893613, 0.884915, 0.879631, 0.876819,
        0.875736, 0.876346, 0.877996, 0.880447, 0.883702, 0.887400, 0.891444, 0.895627,
        0.900036, 0.904470, 0.908801, 0.913134, 0.917341, 0.921534, 0.925564, 0.929307,
        0.933011, 0.936516, 0.939878, 0.943075, 0.946151, 0.949078, 0.951786, 0.954378,
        0.998828, 0.950378, 0.922342, 0.902937, 0.888881, 0.879210, 0.872465, 0.868111,
        0.865913, 0.864899, 0.865237, 0.866622, 0.868594, 0.871372, 0.874483, 0.877978,
        0.881890, 0.885765, 0.889756, 0.893934, 0.897922, 0.902069, 0.906060, 0.910122,
        0.913927, 0.917674, 0.921388, 0.924891, 0.928402, 0.931647, 0.934773, 0.937733,
        0.998724, 0.947952, 0.918822, 0.898473, 0.883413, 0.872506, 0.864577, 0.859037,
        0.855385, 0.853111, 0.852276, 0.852419, 0.853445, 0.855079, 0.857372, 0.860027,
        0.862945, 0.866249, 0.869806, 0.873368, 0.877117, 0.880948, 0.884846, 0.888793,
        0.892660, 0.896327, 0.900209, 0.903846, 0.907552, 0.910937, 0.914478, 0.917846,
        0.998624, 0.945064, 0.914607, 0.892932, 0.877083, 0.864911, 0.855952, 0.849086,
        0.844308, 0.841008, 0.838868, 0.837905, 0.837750, 0.838422, 0.839680, 0.841392,
        0.843642, 0.846112, 0.848856, 0.851933, 0.855299, 0.858562, 0.862056, 0.865699,
        0.869244, 0.872990, 0.876580, 0.880382, 0.883829, 0.887495, 0.891035, 0.894505,
        0.998501, 0.941687, 0.909759, 0.886798, 0.869771, 0.856586, 0.846459, 0.838608,
        0.832591, 0.828184, 0.824968, 0.822975, 0.821861, 0.821363, 0.821596, 0.822288,
        0.823730, 0.825398, 0.827364, 0.829609, 0.832117, 0.834931, 0.837827, 0.841077,
        0.844247, 0.847546, 0.851009, 0.854375, 0.857833, 0.861145, 0.864586, 0.868107,
        0.998367, 0.937920, 0.904059, 0.880078, 0.861760, 0.847444, 0.836137, 0.827190,
        0.820294, 0.814712, 0.810581, 0.807394, 0.805281, 0.803784, 0.802929, 0.802763,
        0.803302, 0.804020, 0.805137, 0.806735, 0.808352, 0.810484, 0.812829, 0.815176,
        0.817832, 0.820673, 0.823555, 0.826500, 0.829579, 0.832725, 0.835802, 0.839016,
        0.998241, 0.933703, 0.898095, 0.872403, 0.852856, 0.837520, 0.825107, 0.815359,
        0.807179, 0.800482, 0.795414, 0.791368, 0.788274, 0.785749, 0.783927, 0.782803,
        0.782413, 0.782237, 0.782511, 0.783124, 0.784043, 0.785432, 0.786878, 0.788500,
        0.790566, 0.792596, 0.794810, 0.797354, 0.799801, 0.802457, 0.805228, 0.807926,
        0.998099, 0.929355, 0.891466, 0.864226, 0.843407, 0.826898, 0.813414, 0.802455,
        0.793297, 0.785755, 0.779605, 0.774584, 0.770348, 0.767015, 0.764395, 0.762505,
        0.761009, 0.760053, 0.759284, 0.759156, 0.759186, 0.759655, 0.760378, 0.761406,
        0.762436, 0.763972, 0.765449, 0.767194, 0.769043, 0.771100, 0.773008, 0.775273,
        0.997942, 0.924596, 0.884580, 0.855702, 0.833485, 0.815605, 0.801132, 0.789058,
        0.779034, 0.770562, 0.763367, 0.757284, 0.752343, 0.748111, 0.744485, 0.741608,
        0.739310, 0.737428, 0.735970, 0.734794, 0.734133, 0.733671, 0.733648, 0.733793,
        0.734041, 0.734568, 0.735374, 0.736467, 0.737554, 0.738776, 0.740168, 0.741654,
        0.997786, 0.919701, 0.877273, 0.846645, 0.823001, 0.803900, 0.788335, 0.775120,
        0.764174, 0.754715, 0.746765, 0.739681, 0.733878, 0.728698, 0.724280, 0.720434,
        0.717419, 0.714555, 0.712384, 0.710302, 0.709090, 0.707617, 0.706846, 0.706159,
        0.705577, 0.705348, 0.705334, 0.705590, 0.705922, 0.706403, 0.707099, 0.707993,
        0.997623, 0.914550, 0.869503, 0.837167, 0.811942, 0.791820, 0.775099, 0.761019,
        0.748960, 0.738588, 0.729829, 0.721807, 0.715162, 0.709223, 0.703838, 0.699419,
        0.695290, 0.691863, 0.688744, 0.685983, 0.683683, 0.681625, 0.679840, 0.678411,
        0.677321, 0.676253, 0.675580, 0.674952, 0.674563, 0.674259, 0.674209, 0.674095,
        0.997456, 0.909191, 0.861611, 0.827624, 0.801054, 0.779381, 0.761557, 0.746377,
        0.733351, 0.722233, 0.712292, 0.703720, 0.696064, 0.689358, 0.683536, 0.677985,
        0.673357, 0.669088, 0.665096, 0.661723, 0.658770, 0.655793, 0.653341, 0.651205,
        0.649241, 0.647696, 0.646117, 0.644895, 0.643495, 0.642845, 0.641871, 0.641213,
        0.997291, 0.903758, 0.853539, 0.817426, 0.789624, 0.766893, 0.747783, 0.731700,
        0.717761, 0.705634, 0.695076, 0.685541, 0.677245, 0.669656, 0.663032, 0.656842,
        0.651421, 0.646183, 0.641880, 0.637960, 0.634014, 0.630578, 0.627327, 0.624742,
        0.621908, 0.619562, 0.617537, 0.615426, 0.613626, 0.611992, 0.610488, 0.609114,
        0.997092, 0.898276, 0.845406, 0.807484, 0.777970, 0.753880, 0.733887, 0.716740,
        0.701914, 0.689122, 0.677463, 0.667501, 0.658283, 0.650066, 0.642687, 0.635856,
        0.629758, 0.624183, 0.618889, 0.614124, 0.610047, 0.605771, 0.602137, 0.598587,
        0.595372, 0.592444, 0.589579, 0.587135, 0.584495, 0.582370, 0.580250, 0.578346,
        0.996921, 0.892506, 0.836944, 0.797144, 0.766158, 0.740982, 0.719778, 0.701865,
        0.686271, 0.672507, 0.660289, 0.649479, 0.639435, 0.630798, 0.622616, 0.615312,
        0.608646, 0.602271, 0.596539, 0.591240, 0.586443, 0.581771, 0.577439, 0.573536,
        0.569789, 0.566324, 0.562916, 0.559902, 0.557046, 0.554124, 0.551414, 0.549026,
        0.996717, 0.886667, 0.828396, 0.786934, 0.754521, 0.728086, 0.705759, 0.686831,
        0.670295, 0.656090, 0.642951, 0.631458, 0.621093, 0.611623, 0.603092, 0.595107,
        0.587777, 0.580951, 0.574810, 0.569128, 0.563626, 0.558493, 0.553781, 0.549084,
        0.545115, 0.541152, 0.537394, 0.533982, 0.530461, 0.527351, 0.524060, 0.521410
});

template <typename T>
constexpr std::array GGX_F1_ALBEDO_COSINE_WEIGHTED_AVERAGE<4, T> = std::to_array<T>
({
        0.999999, 0.999918, 0.999912, 0.999643, 0.998988, 0.997844, 0.996057, 0.993465,
        0.989916, 0.985260, 0.979380, 0.972139, 0.963468, 0.953281, 0.941527, 0.928194,
        0.913311, 0.896879, 0.879003, 0.859806, 0.839386, 0.817932, 0.795660, 0.772699,
        0.749297, 0.725685, 0.702023, 0.678481, 0.655284, 0.632514, 0.610378, 0.588872
});

template <typename T>
constexpr std::array GGX_F1_ALBEDO_COSINE_ROUGHNESS<5, T> = std::to_array<T>
({
        1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        0.951059, 0.999711, 0.999932, 0.999970, 0.999984, 0.999990, 0.999993, 0.999995,
        0.999996, 0.999997, 0.999998, 0.999998, 0.999998, 0.999999, 0.999999, 0.999999,
        0.999999, 0.999999, 0.999999, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        0.984756, 0.993936, 0.998704, 0.999467, 0.999713, 0.999822, 0.999880, 0.999914,
        0.999936, 0.999950, 0.999961, 0.999968, 0.999974, 0.999979, 0.999982, 0.999985,
        0.999988, 0.999989, 0.999991, 0.999992, 0.999994, 0.999994, 0.999995, 0.999996,
        0.999997, 0.999997, 0.999998, 0.999998, 0.999999, 0.999999, 0.999999, 1.000000,
        0.992944, 0.969340, 0.992147, 0.996813, 0.998325, 0.998980, 0.999321, 0.999519,
        0.999641, 0.999726, 0.999783, 0.999828, 0.999859, 0.999882, 0.999904, 0.999918,
        0.999931, 0.999941, 0.999950, 0.999958, 0.999964, 0.999970, 0.999974, 0.999978,
        0.999982, 0.999985, 0.999987, 0.999991, 0.999992, 0.999995, 0.999996, 0.999998,
        0.995934, 0.937099, 0.974857, 0.988630, 0.993911, 0.996314, 0.997555, 0.998274,
        0.998730, 0.999028, 0.999238, 0.999393, 0.999509, 0.999592, 0.999660, 0.999714,
        0.999759, 0.999796, 0.999824, 0.999850, 0.999871, 0.999890, 0.999905, 0.999919,
        0.999931, 0.999941, 0.999952, 0.999961, 0.999969, 0.999973, 0.999979, 0.999986,
        0.997334, 0.920757, 0.950635, 0.972741, 0.984121, 0.990014, 0.993288, 0.995246,
        0.996496, 0.997321, 0.997907, 0.998323, 0.998637, 0.998873, 0.999063, 0.999214,
        0.999330, 0.999432, 0.999510, 0.999581, 0.999640, 0.999691, 0.999727, 0.999770,
        0.999797, 0.999830, 0.999854, 0.999875, 0.999898, 0.999914, 0.999928, 0.999945,
        0.998078, 0.919230, 0.930482, 0.952537, 0.968620, 0.978761, 0.985187, 0.989234,
        0.991931, 0.993795, 0.995122, 0.996074, 0.996799, 0.997350, 0.997786, 0.998130,
        0.998417, 0.998643, 0.998833, 0.998989, 0.999124, 0.999242, 0.999335, 0.999425,
        0.999500, 0.999564, 0.999620, 0.999674, 0.999717, 0.999764, 0.999795, 0.999829,
        0.998500, 0.924349, 0.919271, 0.934120, 0.950462, 0.963437, 0.972811, 0.979422,
        0.984177, 0.987590, 0.990074, 0.991951, 0.993396, 0.994490, 0.995363, 0.996053,
        0.996642, 0.997107, 0.997490, 0.997828, 0.998090, 0.998335, 0.998533, 0.998708,
        0.998880, 0.999009, 0.999124, 0.999229, 0.999326, 0.999414, 0.999487, 0.999563,
        0.998746, 0.931001, 0.915242, 0.921144, 0.933644, 0.946514, 0.957441, 0.966147,
        0.972874, 0.978125, 0.982146, 0.985262, 0.987709, 0.989659, 0.991203, 0.992466,
        0.993504, 0.994374, 0.995101, 0.995697, 0.996220, 0.996661, 0.997066, 0.997391,
        0.997677, 0.997943, 0.998161, 0.998378, 0.998557, 0.998719, 0.998851, 0.998989,
        0.998881, 0.937208, 0.915358, 0.913361, 0.920558, 0.930773, 0.941265, 0.950819,
        0.958936, 0.965650, 0.971130, 0.975602, 0.979229, 0.982266, 0.984757, 0.986771,
        0.988472, 0.989918, 0.991132, 0.992183, 0.993069, 0.993824, 0.994517, 0.995056,
        0.995597, 0.996067, 0.996432, 0.996804, 0.997129, 0.997418, 0.997675, 0.997912,
        0.998951, 0.942001, 0.916926, 0.909403, 0.911095, 0.917751, 0.926220, 0.935093,
        0.943414, 0.951017, 0.957560, 0.963174, 0.967969, 0.972068, 0.975572, 0.978512,
        0.981081, 0.983221, 0.985081, 0.986713, 0.988079, 0.989305, 0.990393, 0.991342,
        0.992200, 0.992929, 0.993587, 0.994174, 0.994728, 0.995202, 0.995633, 0.996021,
        0.998969, 0.945296, 0.918770, 0.907038, 0.904520, 0.907248, 0.913043, 0.920326,
        0.927838, 0.935300, 0.942141, 0.948521, 0.954197, 0.959266, 0.963570, 0.967449,
        0.970883, 0.973870, 0.976500, 0.978816, 0.980861, 0.982641, 0.984262, 0.985662,
        0.986950, 0.988078, 0.989126, 0.990046, 0.990854, 0.991644, 0.992314, 0.992957,
        0.998953, 0.947269, 0.919793, 0.905413, 0.899353, 0.898901, 0.901744, 0.906642,
        0.912874, 0.919381, 0.926079, 0.932457, 0.938372, 0.944038, 0.949080, 0.953843,
        0.957962, 0.961743, 0.965168, 0.968116, 0.970895, 0.973356, 0.975574, 0.977544,
        0.979397, 0.981059, 0.982501, 0.983843, 0.985114, 0.986204, 0.987242, 0.988130,
        0.998907, 0.947893, 0.919858, 0.903466, 0.894786, 0.891491, 0.891859, 0.894416,
        0.898888, 0.903975, 0.909769, 0.915589, 0.921496, 0.927173, 0.932556, 0.937660,
        0.942473, 0.946841, 0.950907, 0.954659, 0.958003, 0.961124, 0.963988, 0.966647,
        0.968963, 0.971258, 0.973248, 0.975143, 0.976843, 0.978417, 0.979892, 0.981204,
        0.998831, 0.947420, 0.918625, 0.900796, 0.890125, 0.884491, 0.882263, 0.882974,
        0.885399, 0.889114, 0.893515, 0.898557, 0.903821, 0.909137, 0.914444, 0.919683,
        0.924723, 0.929504, 0.933965, 0.938173, 0.942137, 0.945800, 0.949278, 0.952544,
        0.955549, 0.958338, 0.960970, 0.963359, 0.965541, 0.967729, 0.969572, 0.971433,
        0.998745, 0.945982, 0.916417, 0.897274, 0.884819, 0.877147, 0.873221, 0.871691,
        0.872338, 0.874310, 0.877553, 0.881359, 0.885643, 0.890260, 0.895266, 0.900328,
        0.905050, 0.909989, 0.914595, 0.919168, 0.923495, 0.927617, 0.931454, 0.935262,
        0.938733, 0.942123, 0.945282, 0.948219, 0.951009, 0.953560, 0.956090, 0.958469,
        0.998643, 0.943685, 0.913054, 0.892538, 0.878649, 0.869407, 0.863583, 0.860431,
        0.859289, 0.859748, 0.861456, 0.864044, 0.867252, 0.871091, 0.875304, 0.879648,
        0.884205, 0.888730, 0.893308, 0.897764, 0.902216, 0.906594, 0.910694, 0.914785,
        0.918673, 0.922450, 0.926073, 0.929472, 0.932726, 0.935834, 0.938875, 0.941636,
        0.998520, 0.940768, 0.908676, 0.886845, 0.871521, 0.860626, 0.853362, 0.848657,
        0.845929, 0.845022, 0.845170, 0.846576, 0.848569, 0.851433, 0.854687, 0.858159,
        0.862116, 0.866207, 0.870434, 0.874556, 0.878965, 0.883248, 0.887470, 0.891555,
        0.895692, 0.899621, 0.903529, 0.907282, 0.910877, 0.914329, 0.917680, 0.921056,
        0.998381, 0.937102, 0.903406, 0.880161, 0.863393, 0.851127, 0.842432, 0.836228,
        0.832182, 0.829659, 0.828588, 0.828596, 0.829485, 0.831088, 0.833371, 0.836080,
        0.839096, 0.842519, 0.846030, 0.849869, 0.853789, 0.857712, 0.861822, 0.865841,
        0.869788, 0.873816, 0.877876, 0.881541, 0.885378, 0.889170, 0.892838, 0.896374,
        0.998233, 0.932972, 0.897383, 0.872450, 0.854426, 0.840624, 0.830655, 0.822948,
        0.817539, 0.813919, 0.811421, 0.810252, 0.809917, 0.810540, 0.811633, 0.813090,
        0.815310, 0.817970, 0.820893, 0.823985, 0.827222, 0.830648, 0.834340, 0.837914,
        0.841746, 0.845469, 0.849189, 0.853061, 0.856895, 0.860725, 0.864206, 0.868024,
        0.998062, 0.928401, 0.890496, 0.864027, 0.844380, 0.829516, 0.817874, 0.809229,
        0.802363, 0.797300, 0.793769, 0.791400, 0.789958, 0.789301, 0.789396, 0.789948,
        0.791152, 0.792767, 0.794777, 0.797083, 0.799650, 0.802525, 0.805455, 0.808530,
        0.811715, 0.815262, 0.818576, 0.822028, 0.825531, 0.829218, 0.832790, 0.836323,
        0.997903, 0.923296, 0.883105, 0.854847, 0.833826, 0.817398, 0.804643, 0.794588,
        0.786671, 0.780405, 0.775606, 0.771960, 0.769445, 0.767631, 0.766710, 0.766190,
        0.766339, 0.767052, 0.768195, 0.769579, 0.771105, 0.773157, 0.775445, 0.777930,
        0.780573, 0.783296, 0.786092, 0.789168, 0.792266, 0.795484, 0.798687, 0.801952,
        0.997722, 0.917944, 0.875329, 0.845196, 0.822506, 0.804677, 0.790617, 0.779275,
        0.770138, 0.762785, 0.756714, 0.752227, 0.748316, 0.745529, 0.743562, 0.742118,
        0.741316, 0.741026, 0.741141, 0.741520, 0.742343, 0.743529, 0.745103, 0.746521,
        0.748364, 0.750545, 0.752701, 0.754976, 0.757549, 0.760151, 0.762928, 0.765632,
        0.997544, 0.912380, 0.866874, 0.835031, 0.810752, 0.791375, 0.776135, 0.763423,
        0.753207, 0.744584, 0.737662, 0.731908, 0.727175, 0.723462, 0.720303, 0.717708,
        0.716096, 0.714763, 0.713804, 0.713380, 0.713254, 0.713573, 0.714283, 0.714955,
        0.716052, 0.717289, 0.718700, 0.720210, 0.721943, 0.723744, 0.725982, 0.728265,
        0.997345, 0.906364, 0.858168, 0.824225, 0.798366, 0.777854, 0.760950, 0.747326,
        0.735957, 0.726322, 0.718046, 0.711461, 0.705744, 0.700754, 0.696685, 0.693300,
        0.690800, 0.688392, 0.686594, 0.685496, 0.684173, 0.683726, 0.683432, 0.683462,
        0.683499, 0.684009, 0.684579, 0.685456, 0.686311, 0.687298, 0.688700, 0.690093,
        0.997148, 0.900193, 0.849204, 0.813238, 0.785864, 0.763719, 0.745904, 0.730908,
        0.718349, 0.707843, 0.698640, 0.690759, 0.684126, 0.678461, 0.673458, 0.669108,
        0.665375, 0.662316, 0.659589, 0.657499, 0.655650, 0.654208, 0.652984, 0.651995,
        0.651232, 0.651024, 0.650708, 0.650742, 0.650937, 0.651296, 0.651926, 0.652366,
        0.996916, 0.893934, 0.839888, 0.801908, 0.772757, 0.749360, 0.730312, 0.714346,
        0.700737, 0.689020, 0.678907, 0.670327, 0.662561, 0.655852, 0.650170, 0.644902,
        0.640410, 0.636525, 0.632993, 0.630100, 0.627311, 0.625218, 0.623019, 0.621387,
        0.620091, 0.618793, 0.617651, 0.616984, 0.616253, 0.615802, 0.615536, 0.615355,
        0.996708, 0.887409, 0.830650, 0.790486, 0.759648, 0.734964, 0.714598, 0.697412,
        0.682874, 0.670267, 0.659323, 0.649677, 0.641294, 0.633841, 0.627006, 0.621144,
        0.615954, 0.611056, 0.606801, 0.603170, 0.599824, 0.596581, 0.594010, 0.591573,
        0.589434, 0.587370, 0.585798, 0.583966, 0.582831, 0.581740, 0.580707, 0.579736,
        0.996489, 0.880857, 0.821045, 0.778843, 0.746457, 0.720462, 0.698778, 0.680707,
        0.665214, 0.651747, 0.639908, 0.629358, 0.620196, 0.611989, 0.604530, 0.597780,
        0.591888, 0.586535, 0.581560, 0.577111, 0.572883, 0.569131, 0.565824, 0.562558,
        0.559866, 0.557381, 0.554870, 0.552565, 0.550665, 0.548742, 0.547201, 0.545921,
        0.996254, 0.874204, 0.811568, 0.767043, 0.733106, 0.705763, 0.683264, 0.664210,
        0.647547, 0.633334, 0.620787, 0.609491, 0.599427, 0.590621, 0.582505, 0.575140,
        0.568488, 0.562516, 0.556989, 0.551732, 0.547223, 0.542818, 0.538830, 0.535175,
        0.531657, 0.528639, 0.525418, 0.522760, 0.520194, 0.517716, 0.515743, 0.513590,
        0.996011, 0.867429, 0.801715, 0.755398, 0.720030, 0.691679, 0.667779, 0.647666,
        0.630100, 0.615243, 0.601916, 0.589844, 0.579383, 0.569883, 0.561067, 0.553312,
        0.545891, 0.539460, 0.533318, 0.527547, 0.522441, 0.517564, 0.513093, 0.508857,
        0.504942, 0.501115, 0.497531, 0.494319, 0.491275, 0.488533, 0.485777, 0.483218,
        0.995781, 0.860602, 0.791876, 0.743747, 0.706970, 0.677083, 0.652356, 0.631367,
        0.613361, 0.597449, 0.583463, 0.570976, 0.559827, 0.549656, 0.540549, 0.532148,
        0.524336, 0.517320, 0.510542, 0.504482, 0.498889, 0.493382, 0.488707, 0.483795,
        0.479364, 0.475299, 0.471589, 0.467747, 0.464296, 0.460953, 0.457854, 0.454659
});

template <typename T>
constexpr std::array GGX_F1_ALBEDO_COSINE_WEIGHTED_AVERAGE<5, T> = std::to_array<T>
({
        0.999999, 0.999891, 0.999885, 0.999534, 0.998682, 0.997200, 0.994898, 0.991575,
        0.987036, 0.981116, 0.973667, 0.964563, 0.953716, 0.941086, 0.926620, 0.910369,
        0.892390, 0.872842, 0.851754, 0.829383, 0.805956, 0.781634, 0.756700, 0.731413,
        0.705975, 0.680653, 0.655593, 0.630972, 0.606982, 0.583764, 0.561378, 0.539915
});

template <typename T>
constexpr std::array GGX_F1_ALBEDO_COSINE_ROUGHNESS<6, T> = std::to_array<T>
({
        1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        0.950981, 0.999710, 0.999932, 0.999971, 0.999984, 0.999990, 0.999993, 0.999995,
        0.999996, 0.999997, 0.999998, 0.999998, 0.999998, 0.999999, 0.999999, 0.999999,
        0.999999, 0.999999, 0.999999, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
        0.984734, 0.993926, 0.998704, 0.999468, 0.999711, 0.999821, 0.999879, 0.999913,
        0.999935, 0.999950, 0.999960, 0.999968, 0.999974, 0.999979, 0.999982, 0.999985,
        0.999988, 0.999989, 0.999991, 0.999992, 0.999993, 0.999995, 0.999995, 0.999996,
        0.999997, 0.999997, 0.999998, 0.999998, 0.999999, 0.999999, 1.000000, 1.000000,
        0.992924, 0.969312, 0.992123, 0.996802, 0.998317, 0.998977, 0.999315, 0.999515,
        0.999638, 0.999723, 0.999782, 0.999822, 0.999857, 0.999881, 0.999902, 0.999917,
        0.999929, 0.999940, 0.999950, 0.999956, 0.999963, 0.999968, 0.999973, 0.999977,
        0.999981, 0.999984, 0.999986, 0.999990, 0.999992, 0.999993, 0.999995, 0.999997,
        0.995919, 0.937068, 0.974770, 0.988608, 0.993884, 0.996277, 0.997529, 0.998262,
        0.998713, 0.999015, 0.999228, 0.999381, 0.999497, 0.999582, 0.999654, 0.999708,
        0.999751, 0.999789, 0.999817, 0.999843, 0.999868, 0.999885, 0.999903, 0.999914,
        0.999929, 0.999938, 0.999947, 0.999955, 0.999965, 0.999971, 0.999977, 0.999983,
        0.997311, 0.920542, 0.950414, 0.972644, 0.983995, 0.989918, 0.993210, 0.995169,
        0.996428, 0.997262, 0.997866, 0.998282, 0.998598, 0.998842, 0.999031, 0.999182,
        0.999308, 0.999401, 0.999486, 0.999561, 0.999614, 0.999670, 0.999711, 0.999745,
        0.999784, 0.999809, 0.999839, 0.999860, 0.999878, 0.999900, 0.999916, 0.999932,
        0.998043, 0.918695, 0.930030, 0.952130, 0.968309, 0.978550, 0.984934, 0.989046,
        0.991756, 0.993638, 0.994967, 0.995955, 0.996663, 0.997252, 0.997698, 0.998054,
        0.998328, 0.998557, 0.998754, 0.998919, 0.999050, 0.999169, 0.999282, 0.999371,
        0.999443, 0.999511, 0.999576, 0.999625, 0.999669, 0.999715, 0.999758, 0.999788,
        0.998451, 0.923501, 0.918425, 0.933315, 0.949811, 0.962822, 0.972244, 0.978938,
        0.983734, 0.987176, 0.989723, 0.991629, 0.993081, 0.994218, 0.995112, 0.995836,
        0.996417, 0.996910, 0.997301, 0.997644, 0.997928, 0.998176, 0.998386, 0.998569,
        0.998724, 0.998873, 0.999004, 0.999106, 0.999199, 0.999300, 0.999381, 0.999449,
        0.998682, 0.929827, 0.913896, 0.919786, 0.932450, 0.945318, 0.956409, 0.965226,
        0.972029, 0.977317, 0.981388, 0.984592, 0.987057, 0.989052, 0.990656, 0.991957,
        0.993019, 0.993909, 0.994664, 0.995299, 0.995840, 0.996310, 0.996713, 0.997051,
        0.997360, 0.997634, 0.997874, 0.998098, 0.998272, 0.998464, 0.998621, 0.998750,
        0.998803, 0.935404, 0.913247, 0.911337, 0.918419, 0.928832, 0.939436, 0.949063,
        0.957348, 0.964157, 0.969732, 0.974336, 0.978031, 0.981094, 0.983663, 0.985730,
        0.987541, 0.989004, 0.990255, 0.991344, 0.992288, 0.993101, 0.993797, 0.994404,
        0.994963, 0.995442, 0.995863, 0.996234, 0.996583, 0.996892, 0.997155, 0.997436,
        0.998852, 0.939536, 0.914003, 0.906156, 0.908034, 0.914742, 0.923366, 0.932372,
        0.940858, 0.948480, 0.955140, 0.960962, 0.965877, 0.970051, 0.973674, 0.976695,
        0.979328, 0.981562, 0.983502, 0.985192, 0.986709, 0.987966, 0.989088, 0.990084,
        0.991013, 0.991784, 0.992480, 0.993134, 0.993657, 0.994196, 0.994673, 0.995106,
        0.998846, 0.942082, 0.914681, 0.902727, 0.900080, 0.902979, 0.908805, 0.916162,
        0.923814, 0.931385, 0.938571, 0.944891, 0.950830, 0.955974, 0.960525, 0.964544,
        0.968074, 0.971175, 0.973882, 0.976308, 0.978446, 0.980340, 0.981995, 0.983495,
        0.984899, 0.986088, 0.987141, 0.988197, 0.989059, 0.989908, 0.990649, 0.991293,
        0.998805, 0.943197, 0.914499, 0.899591, 0.893448, 0.892909, 0.895939, 0.901004,
        0.907171, 0.913908, 0.920704, 0.927161, 0.933433, 0.939147, 0.944452, 0.949206,
        0.953618, 0.957481, 0.961015, 0.964248, 0.967061, 0.969607, 0.971972, 0.974131,
        0.976055, 0.977773, 0.979355, 0.980815, 0.982168, 0.983358, 0.984451, 0.985480,
        0.998730, 0.942855, 0.913265, 0.896161, 0.887181, 0.883592, 0.883920, 0.886714,
        0.891052, 0.896423, 0.902309, 0.908317, 0.914329, 0.920297, 0.925852, 0.931134,
        0.936033, 0.940595, 0.944800, 0.948712, 0.952321, 0.955553, 0.958593, 0.961346,
        0.963975, 0.966397, 0.968444, 0.970480, 0.972286, 0.973971, 0.975587, 0.977008,
        0.998627, 0.941459, 0.910643, 0.891698, 0.880441, 0.874478, 0.872410, 0.872863,
        0.875321, 0.879158, 0.883695, 0.888873, 0.894277, 0.899818, 0.905274, 0.910666,
        0.915835, 0.920713, 0.925423, 0.929899, 0.934083, 0.938021, 0.941695, 0.944984,
        0.948186, 0.951200, 0.953890, 0.956547, 0.958918, 0.961208, 0.963263, 0.965161,
        0.998503, 0.939062, 0.906734, 0.886240, 0.873036, 0.864913, 0.860768, 0.859114,
        0.859699, 0.861819, 0.864916, 0.868808, 0.873423, 0.878217, 0.883332, 0.888420,
        0.893502, 0.898504, 0.903267, 0.907975, 0.912531, 0.916967, 0.921115, 0.924920,
        0.928667, 0.932236, 0.935537, 0.938630, 0.941651, 0.944425, 0.947097, 0.949637,
        0.998365, 0.935689, 0.901849, 0.879698, 0.864670, 0.854824, 0.848480, 0.845385,
        0.843929, 0.844400, 0.845893, 0.848647, 0.851942, 0.855906, 0.860117, 0.864620,
        0.869329, 0.873995, 0.878827, 0.883562, 0.888087, 0.892594, 0.897111, 0.901236,
        0.905418, 0.909278, 0.913115, 0.916735, 0.920182, 0.923516, 0.926698, 0.929713,
        0.998208, 0.931612, 0.895987, 0.871921, 0.855223, 0.843559, 0.835693, 0.830733,
        0.827687, 0.826458, 0.826849, 0.827967, 0.830165, 0.832826, 0.836204, 0.839881,
        0.843872, 0.847864, 0.852388, 0.856884, 0.861181, 0.865709, 0.870030, 0.874445,
        0.878603, 0.882726, 0.886834, 0.890759, 0.894685, 0.898308, 0.901871, 0.905389,
        0.998042, 0.926943, 0.888915, 0.863170, 0.844917, 0.831746, 0.822012, 0.815320,
        0.810925, 0.808173, 0.806987, 0.806903, 0.807628, 0.809179, 0.811523, 0.814152,
        0.817473, 0.820825, 0.824350, 0.828322, 0.832281, 0.836425, 0.840519, 0.844680,
        0.848830, 0.853103, 0.857043, 0.861182, 0.865123, 0.869008, 0.872885, 0.876675,
        0.997844, 0.921627, 0.881255, 0.853772, 0.833569, 0.818652, 0.807529, 0.799381,
        0.793502, 0.789333, 0.786747, 0.785263, 0.784799, 0.785097, 0.786265, 0.787852,
        0.789964, 0.792707, 0.795479, 0.798554, 0.802075, 0.805429, 0.809177, 0.812825,
        0.816754, 0.820705, 0.824508, 0.828450, 0.832484, 0.836287, 0.840132, 0.843903,
        0.997649, 0.915943, 0.872921, 0.843285, 0.821546, 0.805097, 0.792403, 0.782704,
        0.775422, 0.769998, 0.765904, 0.763175, 0.761420, 0.760753, 0.760523, 0.761122,
        0.762215, 0.763762, 0.765728, 0.767941, 0.770642, 0.773321, 0.776302, 0.779475,
        0.782774, 0.786135, 0.789684, 0.793290, 0.796708, 0.800516, 0.804177, 0.807888,
        0.997440, 0.909933, 0.864002, 0.832218, 0.808846, 0.790611, 0.776620, 0.765530,
        0.756589, 0.750076, 0.744645, 0.740674, 0.737772, 0.735768, 0.734595, 0.733986,
        0.733998, 0.734615, 0.735445, 0.736921, 0.738394, 0.740374, 0.742639, 0.745091,
        0.747591, 0.750442, 0.753251, 0.756211, 0.759556, 0.762733, 0.766056, 0.769303,
        0.997228, 0.903388, 0.854530, 0.820689, 0.795357, 0.775865, 0.760212, 0.747767,
        0.737650, 0.729562, 0.723068, 0.717966, 0.713652, 0.710777, 0.708364, 0.706695,
        0.705742, 0.705171, 0.705164, 0.705616, 0.706235, 0.707406, 0.708597, 0.710181,
        0.712032, 0.714035, 0.716151, 0.718370, 0.720971, 0.723403, 0.726221, 0.728911,
        0.996985, 0.896591, 0.844776, 0.808649, 0.781491, 0.760437, 0.743432, 0.729696,
        0.718386, 0.708911, 0.701472, 0.695106, 0.689735, 0.685741, 0.682136, 0.679512,
        0.677439, 0.675990, 0.674866, 0.674363, 0.674035, 0.674167, 0.674684, 0.675356,
        0.676236, 0.677335, 0.678697, 0.680108, 0.681990, 0.683698, 0.685760, 0.687734,
        0.996754, 0.889593, 0.834557, 0.796347, 0.767448, 0.744697, 0.726351, 0.711267,
        0.698747, 0.688407, 0.679557, 0.672153, 0.665970, 0.660688, 0.656244, 0.652614,
        0.649458, 0.647224, 0.645100, 0.643666, 0.642241, 0.641566, 0.641055, 0.640826,
        0.640827, 0.641143, 0.641672, 0.642501, 0.643121, 0.644127, 0.645558, 0.646695,
        0.996504, 0.882415, 0.824303, 0.783864, 0.753043, 0.728863, 0.709291, 0.692877,
        0.679173, 0.667643, 0.657878, 0.649403, 0.642237, 0.635981, 0.630664, 0.625990,
        0.622214, 0.618647, 0.615675, 0.613212, 0.611344, 0.609562, 0.608135, 0.607057,
        0.606404, 0.605790, 0.605417, 0.605370, 0.605226, 0.605541, 0.606021, 0.606499,
        0.996240, 0.875171, 0.813660, 0.771013, 0.738622, 0.712953, 0.691987, 0.674627,
        0.659720, 0.647204, 0.636343, 0.627120, 0.618738, 0.611624, 0.605440, 0.599969,
        0.595129, 0.590979, 0.587227, 0.583881, 0.580965, 0.578548, 0.576412, 0.574558,
        0.572809, 0.571635, 0.570501, 0.569411, 0.568861, 0.568162, 0.567800, 0.567543,
        0.995980, 0.867686, 0.803061, 0.758221, 0.724146, 0.697025, 0.674903, 0.656322,
        0.640595, 0.626973, 0.615222, 0.604908, 0.596047, 0.588126, 0.581079, 0.574619,
        0.569149, 0.564018, 0.559764, 0.555506, 0.551943, 0.548668, 0.545701, 0.543100,
        0.540856, 0.538754, 0.536872, 0.535280, 0.533833, 0.532579, 0.531327, 0.530402,
        0.995714, 0.860198, 0.792515, 0.745396, 0.709624, 0.681110, 0.657936, 0.638117,
        0.621516, 0.607307, 0.594468, 0.583527, 0.573915, 0.565027, 0.557261, 0.550216,
        0.543865, 0.538151, 0.533004, 0.528335, 0.524009, 0.519990, 0.516671, 0.513421,
        0.510317, 0.507743, 0.505202, 0.502800, 0.500748, 0.498898, 0.497165, 0.495457,
        0.995465, 0.852709, 0.781687, 0.732560, 0.695219, 0.665443, 0.641084, 0.620483,
        0.603025, 0.587681, 0.574281, 0.562365, 0.551983, 0.542741, 0.534464, 0.526657,
        0.519651, 0.513440, 0.507644, 0.502244, 0.497603, 0.493101, 0.488888, 0.485098,
        0.481601, 0.478258, 0.475151, 0.472292, 0.469858, 0.467165, 0.464902, 0.462832,
        0.995175, 0.844987, 0.770929, 0.719806, 0.680971, 0.650077, 0.624573, 0.603189,
        0.584855, 0.568839, 0.554745, 0.542285, 0.531142, 0.521177, 0.512242, 0.504117,
        0.496640, 0.489771, 0.483433, 0.477654, 0.472313, 0.467292, 0.462623, 0.458496,
        0.454415, 0.450754, 0.447136, 0.443721, 0.440616, 0.437604, 0.434972, 0.432455,
        0.994863, 0.837400, 0.760357, 0.707125, 0.666959, 0.634878, 0.608362, 0.586116,
        0.567208, 0.550324, 0.535711, 0.522947, 0.511164, 0.500687, 0.491075, 0.482500,
        0.474634, 0.467433, 0.460685, 0.454432, 0.448640, 0.443283, 0.438236, 0.433409,
        0.428980, 0.424886, 0.421111, 0.417356, 0.413719, 0.410339, 0.407396, 0.404172
});

template <typename T>
constexpr std::array GGX_F1_ALBEDO_COSINE_WEIGHTED_AVERAGE<6, T> = std::to_array<T>
({
        0.999999, 0.999864, 0.999858, 0.999427, 0.998385, 0.996578, 0.993783, 0.989762,
        0.984300, 0.977195, 0.968305, 0.957495, 0.944695, 0.929863, 0.913027, 0.894268,
        0.873707, 0.851524, 0.827894, 0.803116, 0.777410, 0.751040, 0.724331, 0.697512,
        0.670870, 0.644576, 0.618848, 0.593886, 0.569766, 0.546578, 0.524407, 0.503328
});

// clang-format on

template <std::size_t N, typename T>
constexpr Interpolation<2, T, T> INTERPOLATION_ALBEDO_COSINE_ROUGHNESS(
        GGX_F1_ALBEDO_COSINE_ROUGHNESS_SIZE,
        GGX_F1_ALBEDO_COSINE_ROUGHNESS<N, T>);

template <std::size_t N, typename T>
constexpr Interpolation<1, T, T> INTERPOLATION_COSINE(
        GGX_F1_ALBEDO_COSINE_WEIGHTED_AVERAGE_SIZE,
        GGX_F1_ALBEDO_COSINE_WEIGHTED_AVERAGE<N, T>);
}

template <std::size_t N, typename T>
T ggx_f1_albedo(const T roughness, const T cosine)
{
        return INTERPOLATION_ALBEDO_COSINE_ROUGHNESS<N, T>.compute(Vector<2, T>(cosine, roughness));
}

template <std::size_t N, typename T>
T ggx_f1_albedo_cosine_weighted_average(const T roughness)
{
        return INTERPOLATION_COSINE<N, T>.compute(Vector<1, T>(roughness));
}

#define CREATE_GGX_F1_ALBEDO_INSTANTIATION_N_T(N, T) \
        template T ggx_f1_albedo<(N)>(T, T);         \
        template T ggx_f1_albedo_cosine_weighted_average<(N)>(T);

#define CREATE_GGX_F1_ALBEDO_INSTANTIATION_N(N)            \
        CREATE_GGX_F1_ALBEDO_INSTANTIATION_N_T((N), float) \
        CREATE_GGX_F1_ALBEDO_INSTANTIATION_N_T((N), double)

CREATE_GGX_F1_ALBEDO_INSTANTIATION_N(3)
CREATE_GGX_F1_ALBEDO_INSTANTIATION_N(4)
CREATE_GGX_F1_ALBEDO_INSTANTIATION_N(5)
CREATE_GGX_F1_ALBEDO_INSTANTIATION_N(6)
}
